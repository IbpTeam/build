#!/bin/bash
echo
echo -----------------------------------
echo Build node modules
echo
set -e
# This script mustn't be run with root rights.
if [ $UID -eq 0 ]; then
    echo Error! You should not run this shell with root rights.
    exit 1
fi
CURRENTPATH=$(cd `dirname $0`; pwd)
. $(cd `dirname $CURRENTPATH`; pwd)/envsetup.sh nosetenv
setenv

pushd $PWD
cd $(gettop)/src/node_modules

for file in `ls`
do
    if [ -d $file ] ; then
        pushd $PWD
        cd $file
        bash $(gettop)/build/core/build_single_module.sh
        popd
    fi
done

cd $(gettop)/app/demo-rio/nodewebkit
bash $(gettop)/build/core/link_modules_for_app.sh $(gettop)/app/demo-rio/nodewebkit
npm link

popd

echo
echo Successed building node modules.
echo ===================================
echo
